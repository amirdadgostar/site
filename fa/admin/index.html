<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÙØ§Ø±Ø´Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <!-- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ÙÙˆÙ†Øª Ù…Ø¯Ø±Ù† ÙˆØ²ÛŒØ±Ù…ØªÙ† Ø¨Ø±Ø§ÛŒ Ø¸Ø§Ù‡Ø± Ø¨Ø³ÛŒØ§Ø± Ø­Ø±ÙÙ‡ Ø§ÛŒ ØªØ± -->
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.0.0/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <style>
        :root {
            --primary: #4f46e5;
            --primary-hover: #4338ca;
            --success: #10b981;
            --success-hover: #059669;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg: #f4f7f6;
            --card-bg: #ffffff;
            --text-dark: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025);
            --transition: all 0.3s ease;
        }

        * { box-sizing: border-box; font-family: 'Vazirmatn', Tahoma, Arial, sans-serif; }
        body { background-color: var(--bg); color: var(--text-dark); margin: 0; padding: 20px; font-size: 15px; }
        
        h1, h2, h3 { margin-top: 0; color: #0f172a; }
        
        .container { max-width: 1200px; margin: 0 auto; }
        
        /* Login Section Styles */
        #adminLoginSection {
            max-width: 400px; margin: 100px auto; background: var(--card-bg); padding: 40px 30px; 
            border-radius: 16px; box-shadow: var(--shadow); text-align: center;
        }
        #adminLoginSection h2 { margin-bottom: 10px; color: var(--primary); }
        #adminLoginSection p { color: var(--text-light); margin-bottom: 30px; font-size: 14px; }
        
        /* Dashboard Section (Hidden by default) */
        #adminDashboardSection { display: none; }

        /* Form Controls */
        .form-group { margin-bottom: 20px; text-align: right; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 14px; color: #334155; }
        .form-group input, .form-group textarea, select { 
            width: 100%; padding: 12px 15px; border: 1px solid var(--border); border-radius: 8px; 
            font-size: 14px; transition: var(--transition); background-color: #f8fafc; color: var(--text-dark);
        }
        .form-group input:focus, .form-group textarea:focus, select:focus { 
            border-color: var(--primary); outline: none; background-color: #ffffff; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); 
        }
        
        /* Buttons */
        .btn { 
            padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; 
            color: white; transition: var(--transition); font-size: 14px; display: inline-flex; align-items: center; justify-content: center;
        }
        .btn-primary { background: linear-gradient(135deg, var(--primary), #6366f1); box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.2); }
        .btn-primary:hover { background: linear-gradient(135deg, var(--primary-hover), var(--primary)); transform: translateY(-1px); }
        .btn-success { background: linear-gradient(135deg, var(--success), #34d399); box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.2); }
        .btn-success:hover { background: linear-gradient(135deg, var(--success-hover), var(--success)); transform: translateY(-1px); }

        /* Add Order Section */
        .add-order-section { 
            background: var(--card-bg); padding: 30px; border-radius: 16px; box-shadow: var(--shadow); 
            margin-bottom: 40px; border-top: 5px solid var(--primary);
        }
        
        /* Kanban Board */
        .kanban-board { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; }
        .column { background: #e2e8f0; padding: 20px; border-radius: 16px; min-height: 500px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.02); }
        .column-header { font-weight: 800; font-size: 16px; margin-bottom: 20px; text-align: center; padding-bottom: 15px; border-bottom: 2px solid rgba(0,0,0,0.05); }
        
        .card { 
            background: var(--card-bg); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); 
            margin-bottom: 15px; border-right: 5px solid var(--primary); transition: var(--transition);
        }
        .card:hover { transform: translateY(-3px); box-shadow: var(--shadow); }
        .card.status-1 { border-color: var(--warning); }
        .card.status-2 { border-color: var(--primary); }
        .card.status-3 { border-color: var(--success); }
        .card-title { font-size: 15px; font-weight: 800; margin-bottom: 12px; word-break: break-all; color: #1e293b; }
        .badge { display: inline-block; padding: 5px 10px; border-radius: 20px; font-size: 12px; font-weight: 700; margin-bottom: 12px; color: white; letter-spacing: 0.5px;}
        .badge-pay-1 { background-color: var(--warning); color: #fffbeb;}
        .badge-pay-2 { background-color: var(--success); }

        /* Modal (Glassmorphism design) */
        .modal-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(4px); 
            display: flex; justify-content: center; align-items: center; 
            z-index: 1000; visibility: hidden; opacity: 0; transition: var(--transition); 
        }
        .modal-overlay.active { visibility: visible; opacity: 1; }
        .modal { 
            background: var(--card-bg); width: 95%; max-width: 850px; max-height: 90vh; 
            overflow-y: auto; padding: 35px; border-radius: 20px; position: relative; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .close-btn { position: absolute; top: 20px; left: 20px; font-size: 28px; cursor: pointer; color: var(--text-light); border: none; background: none; transition: var(--transition); }
        .close-btn:hover { color: var(--danger); transform: scale(1.1); }
        
        .modal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 25px; }
        @media (max-width: 768px) { .modal-grid { grid-template-columns: 1fr; } }
        
        /* Loader */
        .loader-overlay { 
            position: fixed; top:0; left:0; width:100%; height:100%; 
            background: rgba(255,255,255,0.9); backdrop-filter: blur(5px);
            z-index: 2000; display: flex; flex-direction: column; justify-content: center; align-items: center; 
            visibility: hidden; opacity: 0; transition: var(--transition);
        }
        .loader-overlay.active { visibility: visible; opacity: 1; }
        .spinner { border: 4px solid #e2e8f0; border-top: 4px solid var(--primary); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin-bottom: 15px;}
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .readonly-info { background: #f8fafc; padding: 20px; border-radius: 12px; margin-bottom: 25px; font-size: 14px; line-height: 1.8; border: 1px solid var(--border);}
    </style>
</head>
<body>

    <!-- ØµÙØ­Ù‡ Ù„ÙˆØ¯ÛŒÙ†Ú¯ Ú©Ù„ Ø³ÛŒØ³ØªÙ… -->
    <div class="loader-overlay" id="globalLoader">
        <div class="spinner"></div>
        <div id="loaderText" style="font-weight: 700; color: var(--primary); font-size: 16px;">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø±ÛŒ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø¯ÛŒØªØ§Ø¨ÛŒØ³...</div>
    </div>

    <div class="container">
        
        <!-- ÙØ±Ù… ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ± -->
        <div id="adminLoginSection">
            <h2>ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±ÛŒØª</h2>
            <p>Ù„Ø·ÙØ§ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù…Ø¯ÛŒØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯</p>
            <form id="adminLoginForm">
                <div class="form-group">
                    <label>Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</label>
                    <input type="text" id="adminUser" required placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù…Ø¯ÛŒØ±">
                </div>
                <div class="form-group">
                    <label>Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                    <input type="password" id="adminPass" required placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù…Ø¯ÛŒØ±">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 10px;">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„</button>
            </form>
        </div>

        <!-- Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª (Ø§Ø¨ØªØ¯Ø§ Ù…Ø®ÙÛŒ Ø§Ø³Øª) -->
        <div id="adminDashboardSection">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h1 style="margin: 0;">Ù…Ø¯ÛŒØ±ÛŒØª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ø³ÙØ§Ø±Ø´Ø§Øª</h1>
                <button class="btn" style="background-color: #ef4444;" onclick="logoutAdmin()">Ø®Ø±ÙˆØ¬ Ø§Ø² Ù¾Ù†Ù„</button>
            </div>
            
            <!-- ÙØ±Ù… Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ -->
            <div class="add-order-section">
                <h3 style="border-bottom: 2px solid var(--border); padding-bottom: 10px; margin-bottom: 20px;">Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯</h3>
                <form id="addOrderForm" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: end;">
                    <div class="form-group" style="margin: 0;">
                        <label>Ø§ÛŒÙ…ÛŒÙ„ Ú©Ø§Ø±Ø¨Ø±</label>
                        <input type="email" id="newEmail" required placeholder="user@gmail.com">
                    </div>
                    <div class="form-group" style="margin: 0;">
                        <label>Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                        <input type="text" id="newPassword" required placeholder="123456">
                    </div>
                    <div class="form-group" style="grid-column: span 2; margin: 0;">
                        <label>Ø¯Ø³ØªÙˆØ±Ø§Øª Ú©Ø§Ø±Ø¨Ø±</label>
                        <textarea id="newInstructions" rows="4" required placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ùˆ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡..."></textarea>
                    </div>
                    <div style="grid-column: span 2; display: flex; gap: 15px; margin-top: 10px;">
                        <button type="submit" class="btn btn-primary">Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ùˆ Ø§Ø±Ø³Ø§Ù„ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§ÛŒÙ…ÛŒÙ„</button>
                        <button type="button" class="btn btn-success" onclick="loadOrders()">ğŸ”„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª</button>
                    </div>
                </form>
            </div>

            <!-- ØªØ§Ø¨Ù„ÙˆÛŒ Ú©Ø§Ù†Ø¨Ø§Ù† (ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´Ø§Øª) -->
            <div class="kanban-board">
                <div class="column" id="col-new">
                    <div class="column-header" style="color: var(--warning);">Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ (Ø«Ø¨Øª Ø´Ø¯Ù‡)</div>
                    <div class="cards-container"></div>
                </div>
                <div class="column" id="col-progress">
                    <div class="column-header" style="color: var(--primary);">Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</div>
                    <div class="cards-container"></div>
                </div>
                <div class="column" id="col-completed">
                    <div class="column-header" style="color: var(--success);">ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡</div>
                    <div class="cards-container"></div>
                </div>
            </div>
        </div>

    </div>

    <!-- Ù…Ø¯Ø§Ù„ (Ù¾Ù†Ø¬Ø±Ù‡ Ø¨Ø§Ø²Ø´Ùˆ) Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÙØ§Ø±Ø´ -->
    <div class="modal-overlay" id="orderModal">
        <div class="modal">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <h2 style="color: var(--primary); margin-bottom: 20px;">Ø¬Ø²Ø¦ÛŒØ§Øª Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÙØ§Ø±Ø´</h2>
            
            <div class="readonly-info">
                <strong>Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø´ØªØ±ÛŒ:</strong> <span id="m-email" style="color: var(--primary); font-weight: bold;"></span><br>
                <strong>ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª Ø³ÛŒØ³ØªÙ…:</strong> <span id="m-date"></span><br>
                <div style="margin-top: 10px;"><strong>Ø¯Ø³ØªÙˆØ±Ø§Øª Ùˆ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§:</strong> <br><span id="m-instructions" style="color: var(--text-light);"></span></div>
            </div>

            <div class="modal-grid">
                <div class="form-group">
                    <label>ÙˆØ¶Ø¹ÛŒØª Ù…Ø§Ù„ÛŒ / Ù¾Ø±Ø¯Ø§Ø®Øª</label>
                    <select id="m-paymentStatus">
                        <option value="1">Ù‚Ø³Ø· Ø§ÙˆÙ„ (Ù¾ÛŒØ´â€ŒÙ¾Ø±Ø¯Ø§Ø®Øª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡)</option>
                        <option value="2">Ù‚Ø³Ø· Ø¢Ø®Ø± (ØªØ³ÙˆÛŒÙ‡ Ú©Ø§Ù…Ù„ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ÙˆØ¶Ø¹ÛŒØª ÙÙ†ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡</label>
                    <select id="m-orderStatus">
                        <option value="1">Ø«Ø¨Øª Ø§ÙˆÙ„ÛŒÙ‡ (Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯)</option>
                        <option value="2">Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… (ØªÙˆØ³Ø¹Ù‡)</option>
                        <option value="3">ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡ Ù†Ù‡Ø§ÛŒÛŒ (Ø¢Ù…Ø§Ø¯Ù‡ ØªØ­ÙˆÛŒÙ„)</option>
                    </select>
                </div>
            </div>

            <h3 style="margin-top: 30px; border-bottom: 2px solid var(--border); padding-bottom: 10px; color: #334155;">Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙÙ†ÛŒ Ùˆ Ø³ÙˆØ±Ø³â€ŒÚ©Ø¯Ù‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡</h3>
            <p style="font-size: 13px; color: var(--danger); margin-bottom: 20px;">* ØªÙˆØ¬Ù‡: Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ù‡ "ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡ Ù†Ù‡Ø§ÛŒÛŒ"ØŒ Ù¾Ø± Ú©Ø±Ø¯Ù† ØªÙ…Ø§Ù…ÛŒ Û¸ ÙÛŒÙ„Ø¯ Ø²ÛŒØ± Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª.</p>
            
            <div class="modal-grid">
                <div class="form-group"><label>Ø³ÙˆØ±Ø³ Ú©Ø¯ HTML</label><input type="text" id="d-html" placeholder="Ú©Ø¯ ÛŒØ§ Ù„ÛŒÙ†Ú©"></div>
                <div class="form-group"><label>Ø³ÙˆØ±Ø³ Ú©Ø¯ CSS</label><input type="text" id="d-css" placeholder="Ú©Ø¯ ÛŒØ§ Ù„ÛŒÙ†Ú©"></div>
                <div class="form-group"><label>Ø³ÙˆØ±Ø³ Ú©Ø¯ JavaScript</label><input type="text" id="d-js" placeholder="Ú©Ø¯ ÛŒØ§ Ù„ÛŒÙ†Ú©"></div>
                <div class="form-group"><label>Ø³ÙˆØ±Ø³ Ú©Ø¯ Backend</label><input type="text" id="d-backend" placeholder="Ú©Ø¯ ÛŒØ§ Ù„ÛŒÙ†Ú©"></div>
                <div class="form-group"><label>Ø§ÛŒÙ…ÛŒÙ„ Ø§Ú©Ø§Ù†Øª (Ù‡Ø§Ø³Øª/Ø³Ø±ÙˆØ±)</label><input type="email" id="d-accEmail" placeholder="info@domain.com"></div>
                <div class="form-group"><label>Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ú©Ø§Ù†Øª</label><input type="text" id="d-accPass" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±"></div>
                <div class="form-group"><label>Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ GitHub</label><input type="text" id="d-github" placeholder="username"></div>
                <div class="form-group"><label>Ø¢Ø¯Ø±Ø³ Ø³Ø§ÛŒØª (URL)</label><input type="text" id="d-site" placeholder="https://www..."></div>
            </div>

            <div style="margin-top: 30px; text-align: left;">
                <button class="btn btn-success" style="padding: 15px 30px; font-size: 16px;" onclick="saveOrderDetails()">Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª</button>
            </div>
        </div>
    </div>

    <script>
        // Ø¢Ø¯Ø±Ø³ API Ú¯ÙˆÚ¯Ù„ Ø§Ù¾Ø³ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø´Ù…Ø§
        const API_URL = "https://script.google.com/macros/s/AKfycbwAN_TRwVknMCc-x05ug0L1wS1O8HsthawYEb4iLeMPCla_Rpm-U46rlBthq1Pt9w56/exec";
        
        let globalOrders = [];
        let currentEditingEmail = "";
        
        // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±
        let currentAdminUser = "";
        let currentAdminPass = "";

        // ØªÙˆØ§Ø¨Ø¹ Ù„ÙˆØ¯ÛŒÙ†Ú¯
        function showLoader(text = "Ù„Ø·ÙØ§ ØµØ¨Ø± Ú©Ù†ÛŒØ¯...") {
            document.getElementById('loaderText').innerText = text;
            document.getElementById('globalLoader').classList.add('active');
        }
        function hideLoader() { document.getElementById('globalLoader').classList.remove('active'); }

        // Ø¨Ø±Ø±Ø³ÛŒ ÙØ±Ù… ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±
        document.getElementById('adminLoginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const user = document.getElementById('adminUser').value;
            const pass = document.getElementById('adminPass').value;

            showLoader("Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±...");
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify({ action: 'adminLogin', adminUser: user, adminPass: pass })
                });
                const resData = await response.json();
                
                if (resData.success) {
                    // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡
                    currentAdminUser = user;
                    currentAdminPass = pass;
                    // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ÙØ±Ù… Ù„Ø§Ú¯ÛŒÙ† Ùˆ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
                    document.getElementById('adminLoginSection').style.display = 'none';
                    document.getElementById('adminDashboardSection').style.display = 'block';
                    // Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª
                    loadOrders();
                } else {
                    alert("Ø®Ø·Ø§ Ø¯Ø± ÙˆØ±ÙˆØ¯: " + resData.error);
                }
            } catch (error) {
                alert("Ø®Ø·Ø§ÛŒ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±!");
            }
            hideLoader();
        });

        // ØªØ§Ø¨Ø¹ Ø®Ø±ÙˆØ¬ Ù…Ø¯ÛŒØ±
        function logoutAdmin() {
            currentAdminUser = "";
            currentAdminPass = "";
            document.getElementById('adminLoginForm').reset();
            document.getElementById('adminDashboardSection').style.display = 'none';
            document.getElementById('adminLoginSection').style.display = 'block';
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª Ø§Ø² Ø¯ÛŒØªØ§Ø¨ÛŒØ³
        async function loadOrders() {
            showLoader("Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª Ùˆ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ...");
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify({ 
                        action: 'getAdminOrders',
                        adminUser: currentAdminUser,
                        adminPass: currentAdminPass
                    })
                });
                const resData = await response.json();
                
                if (resData.success) {
                    globalOrders = resData.data;
                    renderKanban();
                } else {
                    alert("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª: " + resData.error);
                    if (resData.error.includes("ØºÛŒØ±Ù…Ø¬Ø§Ø²")) logoutAdmin();
                }
            } catch (error) {
                alert("Ø®Ø·Ø§ÛŒ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±!");
            }
            hideLoader();
        }

        // Ø±Ù†Ø¯Ø± Ú©Ø±Ø¯Ù† ØªØ§Ø¨Ù„ÙˆÛŒ Ú©Ø§Ù†Ø¨Ø§Ù†
        function renderKanban() {
            document.querySelector('#col-new .cards-container').innerHTML = '';
            document.querySelector('#col-progress .cards-container').innerHTML = '';
            document.querySelector('#col-completed .cards-container').innerHTML = '';

            globalOrders.forEach(order => {
                const payText = order.paymentStatus == 1 ? "Ù‚Ø³Ø· Ø§ÙˆÙ„" : "ØªØ³ÙˆÛŒÙ‡ Ú©Ø§Ù…Ù„";
                const payClass = order.paymentStatus == 1 ? "badge-pay-1" : "badge-pay-2";
                
                const cardHTML = `
                    <div class="card status-${order.orderStatus}">
                        <div class="card-title">${order.email}</div>
                        <div class="badge ${payClass}">${payText}</div>
                        <div style="font-size: 13px; color: #64748b; margin-bottom: 15px; font-weight: 600;">Øª: ${order.date}</div>
                        <button class="btn btn-primary" style="width: 100%; padding: 8px;" onclick="openModal('${order.email}')">ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª</button>
                    </div>
                `;

                if (order.orderStatus == 1) document.querySelector('#col-new .cards-container').innerHTML += cardHTML;
                else if (order.orderStatus == 2) document.querySelector('#col-progress .cards-container').innerHTML += cardHTML;
                else if (order.orderStatus == 3) document.querySelector('#col-completed .cards-container').innerHTML += cardHTML;
            });
        }

        // Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯
        document.getElementById('addOrderForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('newEmail').value;
            const password = document.getElementById('newPassword').value;
            const instructions = document.getElementById('newInstructions').value;

            showLoader("Ø¯Ø± Ø­Ø§Ù„ Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ØŒ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø´ÛŒØª Ùˆ Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±...");
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify({ 
                        action: 'addOrder', 
                        adminUser: currentAdminUser,
                        adminPass: currentAdminPass,
                        email: email, 
                        password: password, 
                        instructions: instructions 
                    })
                });
                const resData = await response.json();
                
                if (resData.success) {
                    alert("Ø¹Ù…Ù„ÛŒØ§Øª Ù…ÙˆÙÙ‚: Ø³ÙØ§Ø±Ø´ Ø«Ø¨Øª Ø´Ø¯ Ùˆ Ø§ÛŒÙ…ÛŒÙ„ Ø­Ø§ÙˆÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø§Ø±Ø³Ø§Ù„ Ú¯Ø±Ø¯ÛŒØ¯.");
                    document.getElementById('addOrderForm').reset();
                    loadOrders(); // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª
                } else {
                    alert("Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª: " + resData.error);
                }
            } catch (error) {
                alert("Ø®Ø·Ø§ÛŒ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±!");
            }
            hideLoader();
        });

        // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù¾Ù†Ø¬Ø±Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÙØ§Ø±Ø´
        function openModal(email) {
            currentEditingEmail = email;
            const order = globalOrders.find(o => o.email === email);
            if (!order) return;

            // Ù¾Ø± Ú©Ø±Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙÙ‚Ø· Ø®ÙˆØ§Ù†Ø¯Ù†ÛŒ
            document.getElementById('m-email').innerText = order.email;
            document.getElementById('m-date').innerText = order.date;
            document.getElementById('m-instructions').innerText = order.instructions;

            // Ù¾Ø± Ú©Ø±Ø¯Ù† ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§
            document.getElementById('m-paymentStatus').value = order.paymentStatus;
            document.getElementById('m-orderStatus').value = order.orderStatus;

            // Ù¾Ø± Ú©Ø±Ø¯Ù† Ø¬Ø²Ø¦ÛŒØ§Øª
            document.getElementById('d-html').value = order.htmlCode || "";
            document.getElementById('d-css').value = order.cssCode || "";
            document.getElementById('d-js').value = order.jsCode || "";
            document.getElementById('d-backend').value = order.backendCode || "";
            document.getElementById('d-accEmail').value = order.accountEmail || "";
            document.getElementById('d-accPass').value = order.accountPassword || "";
            document.getElementById('d-github').value = order.githubUser || "";
            document.getElementById('d-site').value = order.siteUrl || "";

            document.getElementById('orderModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('orderModal').classList.remove('active');
            currentEditingEmail = "";
        }

        // Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª Ø³ÙØ§Ø±Ø´ (Ø¨Ø§ Ø´Ø±Ø· Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø± Ø¨ÙˆØ¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª)
        async function saveOrderDetails() {
            const payStatus = document.getElementById('m-paymentStatus').value;
            const ordStatus = document.getElementById('m-orderStatus').value;
            
            const details = {
                htmlCode: document.getElementById('d-html').value.trim(),
                cssCode: document.getElementById('d-css').value.trim(),
                jsCode: document.getElementById('d-js').value.trim(),
                backendCode: document.getElementById('d-backend').value.trim(),
                accountEmail: document.getElementById('d-accEmail').value.trim(),
                accountPassword: document.getElementById('d-accPass').value.trim(),
                githubUser: document.getElementById('d-github').value.trim(),
                siteUrl: document.getElementById('d-site').value.trim()
            };

            // Ø´Ø±Ø· Ø¨Ø³ÛŒØ§Ø± Ù…Ù‡Ù…: Ø§Ú¯Ø± ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´ 3 (ØªÚ©Ù…ÛŒÙ„) Ø§Ù†ØªØ®Ø§Ø¨ Ø´ÙˆØ¯ Ø¨Ø§ÛŒØ¯ Ù‡Ø± 8 ÙÛŒÙ„Ø¯ Ù¾Ø± Ø¨Ø§Ø´Ø¯
            if (ordStatus == "3") {
                const allFilled = Object.values(details).every(val => val !== "");
                if (!allFilled) {
                    alert("Ø®Ø·Ø§ÛŒ Ø³ÛŒØ³ØªÙ…: Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ù‡ 'ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡ Ù†Ù‡Ø§ÛŒÛŒ'ØŒ Ø­ØªÙ…Ø§Ù‹ Ø¨Ø§ÛŒØ¯ ØªÙ…Ø§Ù…ÛŒ 8 ÙÛŒÙ„Ø¯ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ Ø³ÙˆØ±Ø³â€ŒÚ©Ø¯Ù‡Ø§ Ø¯Ø± Ù¾Ø§ÛŒÛŒÙ† Ù¾Ø± Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ù†Ø¯.");
                    return; // Ù…ØªÙˆÙ‚Ù Ú©Ø±Ø¯Ù† Ø¹Ù…Ù„ÛŒØ§Øª
                }
            }

            showLoader("Ø¯Ø± Ø­Ø§Ù„ Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª ÙÙ†ÛŒ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³...");
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify({ 
                        action: 'updateOrder', 
                        adminUser: currentAdminUser,
                        adminPass: currentAdminPass,
                        email: currentEditingEmail,
                        paymentStatus: payStatus,
                        orderStatus: ordStatus,
                        details: details
                    })
                });
                const resData = await response.json();
                
                if (resData.success) {
                    alert("Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¢Ù¾Ø¯ÛŒØª Ø´Ø¯.");
                    closeModal();
                    loadOrders(); // Ø±ÙØ±Ø´ Ú©Ø±Ø¯Ù† Ø¬Ø¯ÙˆÙ„
                } else {
                    alert("Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØª: " + resData.error);
                }
            } catch (error) {
                alert("Ø®Ø·Ø§ÛŒ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±!");
            }
            hideLoader();
        }
    </script>
</body>
</html>
